true_w_y2 <- 3
true_Sigma_c <- matrix(c(true_sigma_c[1]*true_sigma_c[1],
true_rhoc*(true_sigma_c[2])*sqrt(true_sigma_c[1]),
true_rhoc*(true_sigma_c[2])*sqrt(true_sigma_c[1]),
true_sigma_c[2]*true_sigma_c[2]), ncol = 2)
true_xic <- matrix(0,nrow = T, ncol = 2)
true_xiy1 <- rep(0, T)
true_xiy2 <- rep(0, T)
true_xics <- rep(0, T)
true_xiy1s <- rep(0, T)
true_xiy2s <- rep(0, T)
true_J<- matrix(0,nrow = T, ncol = 2)
true_delta <- rep(0, T)
for ( i in 1:T){
print(i)
#true jump distribution
set.seed(i + 4922035+ sim)
whichone <- sample(c(0:3),prob = c(0.05,0.05, 0.05,.85), 1)
true_delta[i] <- whichone
set.seed(i + 2352350+ sim)
true_xics[i] <- rexp(1)
set.seed(i + 52352350+ sim)
X<- mvrnorm(n = 1, mu = c(0,0), Sigma = true_Sigma_c)
true_xic[i,] <- (true_w_c*true_xics[i]  + sqrt(true_xics[i] )*X)
set.seed(15866245 + i+ sim)
true_xiy1s[i] <- rexp(1)
true_xiy1[i] <- (true_w_y1*true_xiy1s[i]+ sqrt(true_xiy1s[i])*true_eta_y1*rnorm(1,0,1))
set.seed(57759235+i)
true_xiy2s[i] <- rexp(1)
true_xiy2[i] <- (true_w_y2*true_xiy2s[i]+ sqrt(true_xiy2s[i])*true_eta_y2*rnorm(1,0,1))
true_J[i,] = (true_delta[i] == 2)*true_xic[i,] + (true_delta[i] == 0)*c(true_xiy1[i],0) + (true_delta[i] == 1)*c(0,true_xiy2[i])
Sigma <- matrix(c(true_omega[i,1],true_rho[1]*sqrt(prod(true_omega[i,])),true_rho[3]*true_sigma_v[1]*true_omega[i,1],0,
true_rho[1]*sqrt(prod(true_omega[i,])),true_omega[i,2],0,true_rho[4]*true_sigma_v[2]*true_omega[i,2],
true_rho[3]*true_sigma_v[1]*true_omega[i,1],0,true_sigma_v[1]^2*true_omega[i,1],true_rho[2]*prod(true_sigma_v)*sqrt(prod(true_omega[i,])),
0,true_rho[4]*true_sigma_v[2]*true_omega[i,2],true_rho[2]*prod(true_sigma_v)*sqrt(prod(true_omega[i,])),true_sigma_v[2]^2*true_omega[i,2]),nrow=4)
idx <- 0
set.seed(463468+i + idx + sim)
temp <- rtmvnorm(n = 1,
mean = c(true_mu + true_J[i,],
true_theta + true_phi*(true_omega[i,] - true_theta)),
sigma = Sigma, lower=c(-Inf,-Inf,0,0))
true_omega[i+1,] <- temp[3:4]
y[i,] <- temp[1:2]
}
Vol1 <- data.frame(Time=c(1:1501),
True=true_omega[,1],
Est=keeps$v_mean[,1])
Vol2 <- data.frame(Time=c(1:1501),
True=true_omega[,2],
Est=keeps$v_mean[,2])
J1 <- data.frame(Time=c(1:1500),
True=true_J[,1],
Est=keeps$J_mean[,1])
J2 <- data.frame(Time=c(1:1500),
True=true_J[,2],
Est=keeps$J_mean[,2])
g1 <- ggplot(Vol1) +
geom_line(aes(x=Time,y=True),color="red") +
geom_line(aes(x=Time,y=Est),color="blue") +
ylab("Volatility -- Asset 1")
g2 <- ggplot(Vol2) +
geom_line(aes(x=Time,y=True),color="red") +
geom_line(aes(x=Time,y=Est),color="blue") +
ylab("Volatility -- Asset 2")
g3 <- ggplot(J1) +
geom_line(aes(x=Time,y=True)) +
geom_point(aes(x=Time,y=Est),color='purple') +
ylab("Jump -- Asset 1")
g4 <- ggplot(J2) +
geom_line(aes(x=Time,y=True)) +
geom_point(aes(x=Time,y=Est),color='purple') +
ylab("Jump -- Asset 2")
p1 <- grid.arrange(g1,g3,g2,g4,nrow=2)
head(Vol2)
head(rbind(data.frame(Vol1, series = "1"),
data.frame(Vol2, series = "2")) %>%
melt(id.var = c("Time")))
library(ggplot2)
rbind(data.frame(Vol1, series = "1"),
data.frame(Vol2, series = "2")) %>%
melt(id.var = c("Time")) %>%
ggplot() +
geom_line(aes(x = Time, y = ))
library(reshape2)
head(rbind(data.frame(Vol1, series = "1"),
data.frame(Vol2, series = "2")) %>%
melt(id.var = c("Time")) )
head(rbind(data.frame(Vol1, series = "1"),
data.frame(Vol2, series = "2")))
rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "Series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable )) +
facet_wrap(~series)
rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable )) +
facet_wrap(~series)
rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable )) +
facet_wrap(series~.)
rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable )) +
facet_wrap(series~., nrow = 2)
rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable )) +
facet_wrap(series~., nrow = 2) +
theme_bw()
rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable )) +
facet_wrap(series~., nrow = 2) +
theme_bw() +
scale_colour_grey()
rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable, linetype =variable )) +
facet_wrap(series~., nrow = 2) +
theme_bw() +
scale_colour_grey()
?scale_colour_grey
rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable, linetype =variable )) +
facet_wrap(series~., nrow = 2) +
theme_bw() +
scale_colour_grey(start = .2, end = .6)
vol_plot <- rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable, linetype =variable )) +
facet_wrap(series~., nrow = 2) +
theme_bw() +
scale_colour_grey(start = .2, end = .6)
vol_plot <- rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable, linetype =variable )) +
facet_wrap(series~., nrow = 2) +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none")
vol_plot
vol_plot <- rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable, linetype =variable )) +
facet_wrap(series~., nrow = 2) +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
ggsave("sim_volatility.pdf",vol_plot)
vol_plot
head(rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")))
head(rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) )
vol_plot <- rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) %>%
ggplot() +
geom_point(aes(x = Time, y =True)) +
geom_line(aes(x = Time, y =Est), colour = "grey60") +
facet_wrap(series~., nrow = 2) +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) %>%
ggplot() +
geom_point(aes(x = Time, y =True)) +
geom_line(aes(x = Time, y =Est), colour = "grey60") +
facet_wrap(series~., nrow = 2) +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) %>%
ggplot() +
geom_point(aes(x = Time, y =True)) +
geom_line(aes(x = Time, y =Est), colour = "grey60") +
facet_wrap(series~., nrow = 2) +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
vol_plot <- rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable, linetype =variable )) +
facet_wrap(series~., nrow = 2, scales = "free") +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
vol_plot
ggsave("sim_volatility.pdf",vol_plot)
rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) %>%
ggplot() +
geom_point(aes(x = Time, y =True)) +
geom_line(aes(x = Time, y =Est), colour = "grey60") +
facet_wrap(series~., nrow = 2, scales = "free") +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
jump_plot <- rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) %>%
ggplot() +
geom_point(aes(x = Time, y =True)) +
geom_line(aes(x = Time, y =Est), colour = "grey60") +
facet_wrap(series~., nrow = 2, scales = "free") +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
jump_plot <- rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) %>%
ggplot() +
geom_point(aes(x = Time, y =True)) +
geom_line(aes(x = Time, y =Est), colour = "grey60") +
facet_wrap(series~., nrow = 2, scales = "free") +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
ggsave("sim_jump.pdf",vol_plot)
vol_plot <- rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable, linetype =variable )) +
facet_wrap(series~., nrow = 2, scales = "free") +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
vol_plot
ggsave("sim_volatility.pdf",vol_plot)
jump_plot <- rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) %>%
ggplot() +
geom_point(aes(x = Time, y =True)) +
geom_line(aes(x = Time, y =Est), colour = "grey60") +
facet_wrap(series~., nrow = 2, scales = "free") +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
jump_plot <- rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) %>%
ggplot() +
geom_point(aes(x = Time, y =True)) +
geom_line(aes(x = Time, y =Est), colour = "grey60") +
facet_wrap(series~., nrow = 2, scales = "free") +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
jump_plot
ggsave("sim_jump.pdf",vol_plot)
vol_plot <- rbind(data.frame(Vol1, series = "Asset 1"),
data.frame(Vol2, series = "Asset 2")) %>%
melt(id.var = c("Time", "series")) %>%
ggplot() +
geom_line(aes(x = Time, y =value, colour = variable, linetype =variable )) +
facet_wrap(series~., nrow = 2, scales = "free") +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
vol_plot
ggsave("sim_volatility.pdf",vol_plot)
jump_plot <- rbind(data.frame(J1, series = "Asset 1"),
data.frame(J2, series = "Asset 2")) %>%
ggplot() +
geom_point(aes(x = Time, y =True)) +
geom_line(aes(x = Time, y =Est), colour = "grey60") +
facet_wrap(series~., nrow = 2, scales = "free") +
theme_bw() +
scale_colour_grey(start = .2, end = .6) +
theme(legend.position = "none") +
labs(x = "Time", y = "Volatility")
jump_plot
ggsave("sim_jump.pdf",jump_plot)
ass <- read.csv(file.choose())
ass <- read.csv(file.choose())
str(ass)
ass[,-6] %>%melt(id.var = "Student")
ass[,-6] %>%melt(id.var = "Student") %>%
ggplot( aes(fill=value, x=variable)) +
geom_bar(position="fill", stat="identity")
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
print
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
ggplot( aes(fill=value, x=variable, y = n)) +
geom_bar(position="fill", stat="identity")
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
ggplot( aes(fill=value, x=variable, y = n)) +
geom_bar(position="fill", stat="identity") +
coord_flip()
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=value, x=variable, y = n)) +
geom_bar(position="fill", stat="identity") +
coord_flip()
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar(position="fill", stat="identity") +
coord_flip()
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
coord_flip()
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(label=n), vjust=-1)
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(label=n))
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(label=n, colour = Score))
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(y = n,label=n, colour = Score))
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(x = variable,y = n,label=n, colour = Score))
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(x = variable,y = n,label=n, colour = Score),position=position_stack)
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(x = variable,y = n,label=n, colour = Score),position=position_stack(0.5))
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(x = variable,y = n,label=n),position=position_stack(0.5))
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(x = variable,y = n,label=n),position=position_stack(0.5))+
coord_flip()
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(x = variable,y = n,label=n),position=position_stack(0.5))+
coord_flip() +
scale_fill_brewer()
ass[,-6] %>%melt(id.var = "Student") %>%
group_by(value, variable) %>%
tally() %>%
mutate(Score = factor(value, levels = c(1,2,3,4), labels = c("1 Unacceptable", "2 Developing", "3 Competent", "4 Exceptional"))) %>%
ggplot( aes(fill=Score, x=variable, y = n)) +
geom_bar( stat="identity") +
geom_text( aes(x = variable,y = n,label=n),position=position_stack(0.5))+
coord_flip() +
scale_fill_brewer() +
theme_bw()
3/38
35/38
library(rstan)
?`summary,stanfit-method`
rm(list=ls())
library(tidyverse)
library(quantmod)
##### RHO PLOTS FOR LONG TIME SERIES #####
getSymbols("BTC-USD",from = "2014-09-15",to = "2020-09-30")
BTC <- as.data.frame(`BTC-USD`)
BTC$Date <- seq(as.Date("2014-09-17"),as.Date("2020-09-30"),by="days")
BTC$`BTC-USD.Close`[BTC$Date=="2020-04-17"] <- 7096.18
getSymbols("^GSPC",from = "2014-09-15",to = "2020-09-30")
SP500 <- as.data.frame(`GSPC`)
SP500$Date <- as.Date(rownames(SP500))
S <- merge(BTC,SP500)
T <- nrow(S) - 1
Date <- S$Date
tmp <- data.frame(Date=S$Date[-1])
for (m in c("IND","LD","MVN","MALD")){
keeps <- readRDS(paste0("keeps_long/keepsBTCSP_",m,".rds"))
mu <- keeps$mu[,1]
theta <- keeps$theta[,1]
kappa <- 1 - keeps$phi[,1]
sigmav <- keeps$sigma_v[,1]
J <- keeps$J[,,1]
V <- keeps$v[,,1]
eps_y <- NULL
eps_v <- NULL
for (k in 1:20000){
print(k)
eps_y <- cbind(eps_y,(y - mu[k] - J[k,])/sqrt(V[k,-(T+1)]))
eps_v <- cbind(eps_v,(V[k,-1] - V[k,-(T+1)] - kappa[k]*(theta[k] - V[k,-(T+1)]))/(sigmav[k]*sqrt(V[k,-(T+1)])))
}
rho <- (apply(eps_y*eps_v,1,mean) - apply(eps_y,1,mean)*apply(eps_v,1,mean))/sqrt(apply(eps_y,1,var)*apply(eps_v,1,var))
tmp$tm <- rho
names(tmp)[names(tmp)=="tm"] = m
}
##### RHO PLOTS FOR LONG TIME SERIES #####
getSymbols("BTC-USD",from = "2014-09-15",to = "2020-09-30")
BTC <- as.data.frame(`BTC-USD`)
BTC$Date <- seq(as.Date("2014-09-17"),as.Date("2020-09-30"),by="days")
BTC$`BTC-USD.Close`[BTC$Date=="2020-04-17"] <- 7096.18
getSymbols("^GSPC",from = "2014-09-15",to = "2020-09-30")
SP500 <- as.data.frame(`GSPC`)
SP500$Date <- as.Date(rownames(SP500))
S <- merge(BTC,SP500)
T <- nrow(S) - 1
Date <- S$Date
tmp <- data.frame(Date=S$Date[-1])
y = log(S$`BTC-USD.Close`)[-1] - log(S$`BTC-USD.Close`)[-(T+1)]
for (m in c("IND","LD","MVN","MALD")){
keeps <- readRDS(paste0("keeps_long/keepsBTCSP_",m,".rds"))
mu <- keeps$mu[,1]
theta <- keeps$theta[,1]
kappa <- 1 - keeps$phi[,1]
sigmav <- keeps$sigma_v[,1]
J <- keeps$J[,,1]
V <- keeps$v[,,1]
eps_y <- NULL
eps_v <- NULL
for (k in 1:20000){
print(k)
eps_y <- cbind(eps_y,(y - mu[k] - J[k,])/sqrt(V[k,-(T+1)]))
eps_v <- cbind(eps_v,(V[k,-1] - V[k,-(T+1)] - kappa[k]*(theta[k] - V[k,-(T+1)]))/(sigmav[k]*sqrt(V[k,-(T+1)])))
}
rho <- (apply(eps_y*eps_v,1,mean) - apply(eps_y,1,mean)*apply(eps_v,1,mean))/sqrt(apply(eps_y,1,var)*apply(eps_v,1,var))
tmp$tm <- rho
names(tmp)[names(tmp)=="tm"] = m
}
p <- tmp %>% gather("Model","Rho",-Date) %>%
ggplot() +
geom_line(aes(x=Date,y=Rho,colour=Model)) + theme_bw() + theme(text = element_text(size = 20))
p
ggsave("rho_t_long.pdf",p, height = 10, width = 14)
